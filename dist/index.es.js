import e from"@material-ui/core/Grid";import t from"@material-ui/core/Snackbar";import{withStyles as o}from"@material-ui/core/styles";import r from"@material-ui/icons/CloudUpload";import i from"clsx";import n from"prop-types";import s,{Fragment as a,Component as l}from"react";import p from"react-dropzone";import c from"@material-ui/core/Chip";import u from"@material-ui/core/Fab";import h from"@material-ui/icons/AttachFile";import m from"@material-ui/icons/Delete";import f from"@material-ui/icons/CheckCircle";import d from"@material-ui/icons/Error";import g from"@material-ui/icons/Info";import b from"@material-ui/icons/Close";import v from"@material-ui/core/colors/green";import w from"@material-ui/core/colors/amber";import C from"@material-ui/core/IconButton";import y from"@material-ui/core/SnackbarContent";import x from"@material-ui/icons/Warning";import F from"@material-ui/core/Button";import k from"@material-ui/core/Dialog";import P from"@material-ui/core/DialogActions";import D from"@material-ui/core/DialogContent";import j from"@material-ui/core/DialogTitle";var S=function(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,o){return function r(i,n){try{var s=t[i](n),a=s.value}catch(e){return void o(e)}if(!s.done)return Promise.resolve(a).then((function(e){r("next",e)}),(function(e){r("throw",e)}));e(a)}("next")}))}},z=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},E=function(){function e(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,o,r){return o&&e(t.prototype,o),r&&e(t,r),t}}(),R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},O=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},N=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t};var T,I=(T=S(regeneratorRuntime.mark((function e(t){var o,r,i,n,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return o=e.sent,e.next=5,o.blob();case 5:return r=e.sent,i={type:r.type},n=t.replace(/\?.+/,"").split("/").pop(),s=r.type.split("/").pop(),e.abrupt("return",new File([r],n+"."+s,i));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return T.apply(this,arguments)});function A(t){var o=t.fileObjects,r=t.handleRemove,i=t.showFileNames,n=t.useChipsForPreview,a=t.previewChipProps,l=t.classes;return n?o.map((function(e,t){return s.createElement("div",{key:t},s.createElement(c,R({label:e.file.name,onDelete:r(t),variant:"outlined"},a)))})):s.createElement(e,{container:!0,spacing:8},o.map((function(t,o){var n=function(e){if("image"===e.type.split("/")[0])return!0}(t.file)?s.createElement("img",{className:l.smallPreviewImg,role:"presentation",src:t.data}):s.createElement(h,{className:l.smallPreviewImg});return s.createElement(e,{item:!0,xs:4,key:o,className:l.imageContainer},n,i&&s.createElement("p",null,t.file.name),s.createElement(u,{onClick:r(o),"aria-label":"Delete",className:l.removeBtn},s.createElement(m,null)))})))}A.propTypes={classes:n.object.isRequired,fileObjects:n.arrayOf(n.object).isRequired,handleRemove:n.func.isRequired,showFileNames:n.bool,useChipsForPreview:n.bool,previewChipProps:n.object};var M=o({removeBtn:{transition:".5s ease",position:"absolute",opacity:0,top:-5,right:-5,width:40,height:40},smallPreviewImg:{height:100,width:"initial",maxWidth:"100%",marginTop:5,marginRight:10,color:"rgba(0, 0, 0, 0.87)",transition:"all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms",boxSizing:"border-box",boxShadow:"rgba(0, 0, 0, 0.12) 0 1px 6px, rgba(0, 0, 0, 0.12) 0 1px 4px",borderRadius:2,zIndex:5,opacity:1},imageContainer:{position:"relative",zIndex:10,textAlign:"center","&:hover $smallPreviewImg":{opacity:.3},"&:hover $removeBtn":{opacity:1}}})(A),B={success:f,warning:x,error:d,info:g};function L(e){var t=e.classes,o=e.className,r=e.message,n=e.onClose,a=e.variant,l=function(e,t){var o={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(o[r]=e[r]);return o}(e,["classes","className","message","onClose","variant"]),p=B[a];return s.createElement(y,R({className:i(t[a],o),"aria-describedby":"client-snackbar",message:s.createElement("span",{id:"client-snackbar",className:t.message},s.createElement(p,{className:i(t.icon,t.iconVariant)}),r),action:[s.createElement(C,{key:"close","aria-label":"Close",color:"inherit",className:t.close,onClick:n},s.createElement(b,{className:t.icon}))]},l))}L.propTypes={classes:n.object.isRequired,className:n.string,message:n.node,onClose:n.func,variant:n.oneOf(["success","warning","error","info"]).isRequired};var U=o((function(e){return{success:{backgroundColor:v[600]},error:{backgroundColor:e.palette.error.dark},info:{backgroundColor:e.palette.primary.dark},warning:{backgroundColor:w[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"}}}))(L),W=function(o){function n(e){z(this,n);var t=N(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.handleRemove=function(e){return function(o){o.stopPropagation();var r=t.state.fileObjects,i=r.filter((function(t,o){return o===e}))[0].file;r.splice(e,1),t.setState(r,(function(){t.props.onDelete&&t.props.onDelete(i),t.props.onChange&&t.props.onChange(t.state.fileObjects.map((function(e){return e.file}))),t.setState({openSnackBar:!0,snackbarMessage:t.props.getFileRemovedMessage(i.name),snackbarVariant:"info"})}))}},t.handleCloseSnackbar=function(){t.setState({openSnackBar:!1})},t.state={fileObjects:[],openSnackBar:!1,snackbarMessage:"",snackbarVariant:"success",dropzoneText:e.dropzoneText},t}return O(n,l),E(n,[{key:"componentDidMount",value:function(){this.filesArray(this.props.initialFiles)}},{key:"componentDidUpdate",value:function(e){this.props.dropzoneText!==e.dropzoneText&&this.setState({dropzoneText:this.props.dropzoneText})}},{key:"componentWillUnmount",value:function(){this.props.clearOnUnmount&&this.setState({fileObjects:[]})}},{key:"filesArray",value:function(){var e=S(regeneratorRuntime.mark((function e(t){var o,r,i,n,s,a,l,p=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,o=regeneratorRuntime.mark((function e(t){var o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I(t);case 2:o=e.sent,(r=new FileReader).onload=function(e){p.setState({fileObjects:p.state.fileObjects.concat({file:o,data:e.target.result})})},r.readAsDataURL(o);case 6:case"end":return e.stop()}}),e,p)})),r=!0,i=!1,n=void 0,e.prev=5,s=t[Symbol.iterator]();case 7:if(r=(a=s.next()).done){e.next=13;break}return l=a.value,e.delegateYield(o(l),"t0",10);case 10:r=!0,e.next=7;break;case 13:e.next=19;break;case 15:e.prev=15,e.t1=e.catch(5),i=!0,n=e.t1;case 19:e.prev=19,e.prev=20,!r&&s.return&&s.return();case 22:if(e.prev=22,!i){e.next=25;break}throw n;case 25:return e.finish(22);case 26:return e.finish(19);case 27:e.next=32;break;case 29:e.prev=29,e.t2=e.catch(0),console.log(e.t2);case 32:case"end":return e.stop()}}),e,this,[[0,29],[5,15,19,27],[20,,22,26]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onDrop",value:function(e){var t=this,o=this;if(this.props.filesLimit>1&&this.state.fileObjects.length+e.length>this.props.filesLimit)this.setState({openSnackBar:!0,snackbarMessage:this.props.getFileLimitExceedMessage(this.props.filesLimit),snackbarVariant:"error"});else{var r=0,i="";Array.isArray(e)||(e=[e]),e.forEach((function(n){var s=new FileReader;s.onload=function(s){o.setState({fileObjects:t.props.filesLimit<=1?[{file:n,data:s.target.result}]:o.state.fileObjects.concat({file:n,data:s.target.result})},(function(){t.props.onChange&&t.props.onChange(o.state.fileObjects.map((function(e){return e.file}))),t.props.onDrop&&t.props.onDrop(n),i+=t.props.getFileAddedMessage(n.name),++r===e.length&&t.setState({openSnackBar:!0,snackbarMessage:i,snackbarVariant:"success"})}))},s.readAsDataURL(n)}))}}},{key:"handleDropRejected",value:function(e,t){var o=this,r="";e.forEach((function(e){r=o.props.getDropRejectMessage(e,o.props.acceptedFiles,o.props.maxFileSize)})),this.props.onDropRejected&&this.props.onDropRejected(e,t),this.setState({openSnackBar:!0,snackbarMessage:r,snackbarVariant:"error"})}},{key:"render",value:function(){var o=this.props.classes,n=this.props.showPreviews&&this.state.fileObjects.length>0,l=this.props.showPreviewsInDropzone&&this.state.fileObjects.length>0;return s.createElement(a,null,s.createElement(p,{accept:this.props.acceptedFiles.join(","),onDrop:this.onDrop.bind(this),onDropRejected:this.handleDropRejected.bind(this),className:i(this.props.dropzoneClass,o.dropZone),acceptClassName:o.stripes,rejectClassName:o.rejectStripes,maxSize:this.props.maxFileSize,multiple:this.props.filesLimit>1},s.createElement("div",{className:o.dropzoneTextStyle},s.createElement("p",{className:i(o.dropzoneParagraph,this.props.dropzoneParagraphClass)},this.state.dropzoneText),s.createElement(r,{className:o.uploadIconSize})),l&&s.createElement(M,{fileObjects:this.state.fileObjects,handleRemove:this.handleRemove.bind(this),showFileNames:this.props.showFileNames,useChipsForPreview:this.props.useChipsForPreview,previewChipProps:this.props.previewChipProps})),n&&s.createElement(a,null,s.createElement(e,{container:!0},s.createElement("span",null,"Preview:")),s.createElement(M,{fileObjects:this.state.fileObjects,handleRemove:this.handleRemove.bind(this),showFileNames:this.props.showFileNamesInPreview,useChipsForPreview:this.props.useChipsForPreview,previewChipProps:this.props.previewChipProps})),this.props.showAlerts&&s.createElement(t,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:this.state.openSnackBar,autoHideDuration:6e3,onClose:this.handleCloseSnackbar},s.createElement(U,{onClose:this.handleCloseSnackbar,variant:this.state.snackbarVariant,message:this.state.snackbarMessage})))}}]),n}();W.defaultProps={acceptedFiles:["image/*","video/*","application/*"],filesLimit:3,maxFileSize:3e6,dropzoneText:"Drag and drop an image file here or click",showPreviews:!1,showPreviewsInDropzone:!0,showFileNames:!1,showFileNamesInPreview:!1,previewChipProps:{},showAlerts:!0,clearOnUnmount:!0,initialFiles:[],getFileLimitExceedMessage:function(e){return"Maximum allowed number of files exceeded. Only "+e+" allowed"},getFileAddedMessage:function(e){return"File "+e+" successfully added."},getFileRemovedMessage:function(e){return"File "+e+" removed."},getDropRejectMessage:function(e,t,o){var r,i="File "+e.name+" was rejected. ";return t.includes(e.type)||(i+="File type not supported. "),e.size>o&&(i+="File is too big. Size limit is "+((r=o)>=1e6?r/1e6+" megabytes":r>=1e3?r/1e3+" kilobytes":r+" bytes")+". "),i},onChange:function(){},onDrop:function(){},onDropRejected:function(){},onDelete:function(){}},W.propTypes={classes:n.object.isRequired,acceptedFiles:n.array,filesLimit:n.number,maxFileSize:n.number,dropzoneText:n.string,dropzoneClass:n.string,dropzoneParagraphClass:n.string,showPreviews:n.bool,showPreviewsInDropzone:n.bool,showFileNames:n.bool,showFileNamesInPreview:n.bool,useChipsForPreview:n.bool,previewChipProps:n.object,showAlerts:n.bool,clearOnUnmount:n.bool,initialFiles:n.arrayOf(n.string),getFileLimitExceedMessage:n.func,getFileAddedMessage:n.func,getFileRemovedMessage:n.func,getDropRejectMessage:n.func,onChange:n.func,onDrop:n.func,onDropRejected:n.func,onDelete:n.func};var _=o({"@keyframes progress":{"0%":{backgroundPosition:"0 0"},"100%":{backgroundPosition:"-70px 0"}},dropZone:{position:"relative",width:"100%",minHeight:"250px",backgroundColor:"#F0F0F0",border:"dashed",borderColor:"#C8C8C8",cursor:"pointer",boxSizing:"border-box"},stripes:{border:"solid",backgroundImage:"repeating-linear-gradient(-45deg, #F0F0F0, #F0F0F0 25px, #C8C8C8 25px, #C8C8C8 50px)",animation:"progress 2s linear infinite !important",backgroundSize:"150% 100%"},rejectStripes:{border:"solid",backgroundImage:"repeating-linear-gradient(-45deg, #fc8785, #fc8785 25px, #f4231f 25px, #f4231f 50px)",animation:"progress 2s linear infinite !important",backgroundSize:"150% 100%"},dropzoneTextStyle:{textAlign:"center"},uploadIconSize:{width:51,height:51,color:"#909090"},dropzoneParagraph:{fontSize:24}})(W),V=function(e){function t(e){z(this,t);var o=N(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.state={open:!1,files:[],disabled:!0},o}return O(t,e),E(t,[{key:"componentDidUpdate",value:function(e,t){this.props.open!==e.open&&(this.setState({open:this.props.open}),this.props.onClose&&!this.props.open&&this.props.onClose()),this.state.files.length!==t.files.length&&this.setState({disabled:0===this.state.files.length})}},{key:"componentWillUnmount",value:function(){this.props.clearOnUnmount&&this.setState({files:[]})}},{key:"handleClose",value:function(e){this.props.onClose&&this.props.onClose(e),this.setState({open:!1})}},{key:"onChange",value:function(e){var t=this;this.props.logEvents&&console.log("Files changed",e),this.setState({files:e},(function(){t.props.onChange&&t.props.onChange(e)}))}},{key:"onDelete",value:function(e){this.props.logEvents&&console.log("File removed",e),this.props.onDelete&&this.props.onDelete(e)}},{key:"onDrop",value:function(e){this.props.logEvents&&console.log("Files dropped",e),this.props.onDrop&&this.props.onDrop(e)}},{key:"onDropRejected",value:function(e,t){this.props.logEvents&&console.log("Files rejected",e),this.props.onDropRejected&&this.props.onDropRejected(e,t)}},{key:"handleSaveClick",value:function(){this.props.onSave&&this.props.onSave(this.state.files)}},{key:"render",value:function(){return s.createElement(a,null,s.createElement(k,R({},this.props.dialogProps,{open:this.state.open,onClose:this.handleClose.bind(this),maxWidth:this.props.maxWidth,fullWidth:this.props.fullWidth}),s.createElement(j,null,this.props.dialogTitle),s.createElement(D,null,s.createElement(_,{dropzoneText:this.props.dropzoneText,acceptedFiles:this.props.acceptedFiles,filesLimit:this.props.filesLimit,maxFileSize:this.props.maxFileSize,showPreviews:this.props.showPreviews,showPreviewsInDropzone:this.props.showPreviewsInDropzone,showFileNames:this.props.showFileNames,showAlerts:this.props.showAlerts,onChange:this.onChange.bind(this),onDrop:this.onDrop.bind(this),onDropRejected:this.onDropRejected.bind(this),onDelete:this.onDelete.bind(this),clearOnUnmount:this.props.clearOnUnmount,showFileNamesInPreview:this.props.showFileNamesInPreview,useChipsForPreview:this.props.useChipsForPreview,previewChipProps:this.props.previewChipProps})),s.createElement(P,null,s.createElement(F,{color:"primary",onClick:this.handleClose.bind(this)},this.props.cancelButtonText),s.createElement(F,{color:"primary",disabled:this.state.disabled,onClick:this.handleSaveClick.bind(this)},this.props.submitButtonText))))}}]),t}(s.Component);V.defaultProps={open:!1,acceptedFiles:["image/*","video/*","application/*"],filesLimit:3,maxFileSize:3e6,showPreviews:!0,showPreviewsInDropzone:!1,showFileNamesInPreview:!0,previewChipProps:{},showAlerts:!0,clearOnUnmount:!0,dialogTitle:"Upload file",dialogProps:{},submitButtonText:"Submit",cancelButtonText:"Cancel",maxWidth:"sm",fullWidth:!0,onSave:function(){},onDelete:function(){},onClose:function(){},onChange:function(){},onDrop:function(){},onDropRejected:function(){},logEvents:!1},V.propTypes={open:n.bool.isRequired,onSave:n.func,onDelete:n.func,onClose:n.func,onChange:n.func,onDrop:n.func,onDropRejected:n.func,acceptedFiles:n.array,filesLimit:n.number,maxFileSize:n.number,dropzoneText:n.string,showPreviews:n.bool,showPreviewsInDropzone:n.bool,showFileNames:n.bool,showFileNamesInPreview:n.bool,useChipsForPreview:n.bool,previewChipProps:n.object,showAlerts:n.bool,clearOnUnmount:n.bool,dialogTitle:n.string,dialogProps:n.object,submitButtonText:n.string,cancelButtonText:n.string,maxWidth:n.string,fullWidth:n.bool,logEvents:n.bool};export{_ as DropzoneArea,V as DropzoneDialog};
//# sourceMappingURL=index.es.js.map
